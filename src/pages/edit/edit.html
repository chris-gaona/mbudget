<ion-header>
  <ion-navbar id="header">
    <ion-title text-capitalize id="home">
      Edit - {{item.item}}
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content id="edit-container">

  <ion-list>

    <p class="edit-header" padding no-margin>
      Let's do some edits!
    </p>

    <ion-item class="paid no-bottom-border">
      <ion-label>Mark this item fully paid?</ion-label>
      <ion-checkbox color="secondary" checked="false" [(ngModel)]="item.paid"></ion-checkbox>
    </ion-item>

    <ion-item class="no-bottom-border">
      <ion-label *ngIf="!item.due_date">No due date set</ion-label>
      <ion-label *ngIf="item.due_date">{{parseDate(item.due_date)}}</ion-label>
      <ion-toggle checked="true" [(ngModel)]="item.due" (ngModelChange)="presentPopover($event)"></ion-toggle>
    </ion-item>

    <ion-list-header>
      Projection
    </ion-list-header>

    <ion-item no-padding class="projection-name">
      <ion-icon name="information-circle" item-left class="no-margin" color="primary"></ion-icon>
      <ion-input text-capitalize ion-text color="primary" type="text" [(ngModel)]="item.item" class="no-padding"></ion-input>
    </ion-item>

    <ion-item padding-top id="edit-question">
      <p>How much do you expect to spend?</p>
    </ion-item>

    <!--Must comment out this range section in order to not break test with Haptic provider issue!!-->
    <ion-item id="projection-range">
      <ion-range min="0" max="1000" step="5" pin="true" [(ngModel)]="item.projection" color="dark">
        <ion-icon range-left small name="logo-usd" color="primary"></ion-icon>
        <ion-icon range-right name="logo-usd" color="primary"></ion-icon>
      </ion-range>
    </ion-item>
    <!--END-->

    <ion-item no-padding padding-bottom class="projection-amount">
      <ion-icon name="logo-usd" item-left class="no-margin" color="primary"></ion-icon>
      <ion-input id="projection-input" ion-text color="primary" type="number" [(ngModel)]="item.projection" class="no-padding"></ion-input>
    </ion-item>

    <ion-list-header>
      Actual
    </ion-list-header>

    <ion-item *ngIf="item.projection - getActualTotal(item) >= 0">
      You have <b ion-text>{{item.projection - getActualTotal(item) | currency:'USD':true}}</b> left for this budget item.
    </ion-item>

    <ion-item *ngIf="item.projection - getActualTotal(item) < 0">
      Uh oh...you're <b ion-text color="danger">{{item.projection - getActualTotal(item) | currency:'USD':true}}</b> over budget.
    </ion-item>

    <ion-grid class="edit-subcontainer">
      <ion-row *ngFor="let actual of item.actual">
        <ion-col width-50 no-padding>
          <ion-item no-padding>
            <!--<ion-icon name="information-circle" item-left class="no-margin"></ion-icon>-->
            <ion-icon id="toggle-switch" name="{{actual.expense ? 'remove-circle' : 'add-circle'}}" item-left class="no-margin" [class.indicator-subtract]="actual.expense" [class.indicator-add]="!actual.expense" (click)="toggleAddSubtract(actual)"></ion-icon>
            <ion-input text-capitalize type="text" [(ngModel)]="actual.name" class="no-padding"></ion-input>
          </ion-item>
        </ion-col>
        <ion-col width-50 no-padding>
          <ion-item no-padding>
            <ion-icon name="logo-usd" item-left class="no-margin"></ion-icon>
            <ion-input type="number" [(ngModel)]="actual.amount" class="no-padding"></ion-input>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-grid>

    <ion-item class="edit-subcontainer">
      <ion-buttons left>
        <button ion-button color="lighter" icon-only margin-left (click)="addActualItem(item.actual)">
          <ion-icon name="add"></ion-icon>
        </button>
        <button ion-button margin-left (click)="saveAll(); loading = true" [disabled]="loading" [class.loading]="loading">
          {{loading ? 'Loading...' : 'Save'}}
          <span id="loading-spinner" *ngIf="loading"></span>
        </button>

        <button ion-button color="danger" icon-only margin-left (click)="showCheckbox()">
          <ion-icon name="trash"></ion-icon>
        </button>
      </ion-buttons>
    </ion-item>

  </ion-list>

</ion-content>
